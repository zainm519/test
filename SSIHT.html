<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Salle SSIHT</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- üéûÔ∏è Assets -->
      <a-assets>
        <video id="flux-video" autoplay="false" loop="true" muted src="Flux-Video.mp4"></video>
        <video id="video-survpas" autoplay="false" loop="true" muted src="./ALCE5581.mp4"></video>
        <a-asset-item id="bouton" src="./bouton-camera.obj"></a-asset-item>
        <a-asset-item id="alar" src="./alarme.glb"></a-asset-item>
        <a-asset-item id="survpas" src="./surveillance_camerapaspied.glb"></a-asset-item>
        <a-asset-item id="surv" src="./surveillance_camerapied.glb"></a-asset-item>
        <img id="salless" src="./sallessihtb.jpg" />
        <img id="offline-img" src="./OFFLINE.jpg" /> <!-- üÜï Ajout -->
        <audio id="alarmsound" src="./alarme-342932.mp3" preload="auto"></audio>
      </a-assets>

      <!-- üî¥ Bouton 3D -->
      <a-obj-model
        id="videoButton"
        class="clickable"
        src="#bouton"
        position="-9.52687 -19.40063 19.98393"
        material="color: #ff0000"
        rotation="-89.87416 179.99985 179.99985"
        scale="0.03 0.03 0.03">
      </a-obj-model>

      <!-- üé¨ √âcran vid√©o principal -->
      <a-video
        id="videoScreen"
        src="#flux-video"
        width="16"
        height="9"
        position="-2.2995 -5.90513 8.79376"
        rotation="0.32945 -174.604 5.9679"
        scale="0.22282 0.22972 1">
      </a-video>

      <!-- üñºÔ∏è Image OFFLINE (superpos√©e mais cach√©e au d√©part) -->
      <a-image
        id="offlineImage"
        src="#offline-img"
        width="16"
        height="9"
        position="-2.2995 -5.90513 8.79376"
        rotation="0.32945 -174.604 5.9679"
        scale="0.22282 0.22972 1"
        visible="false">
      </a-image>

      <!-- üåå Ciel -->
      <a-sky src="#salless"></a-sky>

      <!-- üé• Cam√©ra du joueur -->
      <a-entity camera position="0 1.6 0" look-controls>
        <a-entity cursor="rayOrigin: mouse"></a-entity>
      </a-entity>

      <!-- üé• Cam√©ras et alarme (inchang√©es) -->
      <a-entity id="surv" gltf-model="#surv" position="-31.71937 19.99428 49.34695" scale="15 15 15" rotation="-17.79 -33.49 11.10"></a-entity>
      <a-entity id="survpas" gltf-model="#survpas" position="-4.74865 3.94615 7.22221" scale="2.5 2.5 2.5" rotation="17.39 147.23 -1.12"
        animation="property: rotation; dir: alternate; dur: 2000; easing: easeInOutSine; to: 17.39 167.23 -1.12; loop: true"></a-entity>

      <a-entity id="alarme" gltf-model="#alar" position="-13.79992 -30.02283 22.72893" scale="13 13 13" rotation="0 120 0"
        class="clickable" sound="src: #alarmsound; autoplay: false; volume: 2"></a-entity>
    </a-scene>

    <script>
      // --- üî¥ Bouton vid√©o + OFFLINE ---
      const video = document.querySelector('#flux-video');
      const videoButton = document.querySelector('#videoButton');
      const offlineImage = document.querySelector('#offlineImage');
      const videoScreen = document.querySelector('#videoScreen');

      videoButton.addEventListener('click', () => {
        const isOffline = offlineImage.getAttribute('visible');

        if (!isOffline) {
          // Met en OFFLINE
          offlineImage.setAttribute('visible', true);
          video.pause();
          videoButton.setAttribute('material', 'color: #ff0000');
          videoButton.removeAttribute('animation__pulse');
        } else {
          // Reprend la vid√©o
          offlineImage.setAttribute('visible', false);
          video.play();
          videoButton.setAttribute('material', 'color: green');
          videoButton.setAttribute(
            'animation__pulse',
            'property: scale; to: 0.035 0.035 0.035; dir: alternate; dur: 600; loop: true; easing: easeInOutSine'
          );
        }
      });
    </script>
  </body>
</html>
