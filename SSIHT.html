<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Mon Monde SSI</title>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
</head>
<body>
<a-scene>
  <!-- Assets -->
  <a-assets>
    <a-asset-item id="came" src="./caméra_cctv_low-poly.glb"></a-asset-item>
    <a-asset-item id="surv" src="./surveillance_camera.glb"></a-asset-item>
    <a-asset-item id="alar" src="./alarme.glb"></a-asset-item>
    <img id="salless" src="./sallessihtb.jpg" />
    <!-- Ciel en feu -->
    <img id="sallessfire" src="./sallessihtb_fire.jpg" />
  </a-assets>

  <!-- Ciel -->
  <a-sky id="sky" src="#salless"></a-sky>

  <!-- Caméra -->
  <a-entity camera position="0 1.6 0" look-controls>
    <a-entity cursor="rayOrigin: mouse"></a-entity>
  </a-entity>

  <!-- Modèles -->
  <a-entity gltf-model="#came" position="0 1 -3" scale="0.5 0.5 0.5"></a-entity>

  <a-entity gltf-model="#surv"
            position="-13.8 6.88047 13.41928"
            scale="5 5 5"
            rotation="19.846 140.141 -15.825">
  </a-entity>

  <!-- ALARME avec ID -->
  <a-entity id="alarme"
            gltf-model="#alar"
            position="-13.79992 -30.02283 22.72893"
            scale="13 13 13"
            rotation="0 120 0"
            class="clickable">
  </a-entity>
</a-scene>

<script>
  const alarm = document.querySelector('#alarme');
  const sky = document.querySelector('#sky');

  alarm.addEventListener('click', () => {
    if (alarm.classList.contains('triggered')) return;
    alarm.classList.add('triggered');

    // Ajouter une lumière orange (feu)
    const flameLight = document.createElement('a-entity');
    flameLight.setAttribute('light', 'type: point; color: orange; intensity: 2; distance: 5');
    flameLight.setAttribute('position', '0 1 0');
    alarm.appendChild(flameLight);

    // Ajouter une sphère animée pour simuler une flamme
    const flame = document.createElement('a-sphere');
    flame.setAttribute('position', '0 1 0');
    flame.setAttribute('radius', '0.3');
    flame.setAttribute('material', 'color: orange; emissive: red; opacity: 0.6; transparent: true');
    flame.setAttribute('animation', 'property: scale; to: 1.3 1.5 1.3; dir: alternate; dur: 200; loop: true');
    alarm.appendChild(flame);

   // Modifier le ciel après 1 seconde
setTimeout(() => {
  sky.setAttribute('src', '#sallessfire');

  // Revenir au ciel normal après 10 secondes
  setTimeout(() => {
    sky.setAttribute('src', '#salless');
  }, 3000); // 3000 ms = 3 secondes

</script>
</body>
</html>
